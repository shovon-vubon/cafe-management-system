<!DOCTYPE html>
<html>
  <head>
	<script defer src="./injectScript.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta charset="utf-8" />
    <link rel="stylesheet" href="styleguide.css" />
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>

     <header>
     <div class="logo"><a href="index.html"><img class="logom" src="img/logo-1.png" /></a></div>
     <div class="nav-bar">
        <div class="buttons">
          <button class="back-button" onclick="window.history.back()"><img class="arrow" src="img/arrow.png" /></button>
          <a href="homepage.html" class="scan-button"><img class="scan" src="img/scan.png" /></a>
          <button class="profile-button" onclick="toggleProfileDropdown()"><img class="user" src="img/user.png" /></button>
        </div>
        <div id="profileDropdown" class="profile-dropdown">
          <div class="dropdown-header">
            <div class="dropdown-user-icon">
              <img class="dropdown-user" src="img/user.png" />
            </div>
            <div class="dropdown-user-info">
              <div class="dropdown-username">Admin12</div>
              <div class="dropdown-email">admin123@gmail.com</div>
            </div>
          </div>
          <button class="logout-button" onclick="logout()">Logout</button>
        </div>
      </div>
    </header>

    <div class="orders">
      <img class="burger-frenchfry" src="https://c.animaapp.com/mjq8ikrsnUCmne/img/burger-frenchfry.png" />

      <div class="login-card">
      <div class="all-orders">
        
              <div class="order-1">
                <div class="rectangle"></div>
                <img
                  class="rounded-rectangle"
                  src="img/coffee.png"
                />
                <div class="text-wrapper">Coffee</div>
                <div class="text-wrapper-2">ID #3567</div>
                <div class="text-wrapper-3">Table: B6</div>
                <div class="rectangle-2"></div>
                <div class="rectangle-3"></div>
                <div class="text-wrapper-4">Paid</div>
                <div class="text-wrapper-5"><button class="link-button" style="border:none;background:none;padding:0;margin:0;font:inherit;color:inherit;cursor:pointer;">Cancel</button></div>
                <div class="text-wrapper-6"><button class="link-button" style="border:none;background:none;padding:0;margin:0;font:inherit;color:inherit;cursor:pointer;">Arrived</button></div>
              </div>

              <div class="order-1">
                <div class="rectangle"></div>
                <img
                  class="rounded-rectangle"
                  src="img/cake.png"
                />
                <div class="text-wrapper">Fruit Cake</div>
                <div class="text-wrapper-2">ID #3567</div>
                <div class="text-wrapper-3">Table: B8</div>
                <div class="rectangle-2"></div>
                <div class="rectangle-3"></div>
                <div class="text-wrapper-4">Paid</div>
                <div class="text-wrapper-5"><button class="link-button" style="border:none;background:none;padding:0;margin:0;font:inherit;color:inherit;cursor:pointer;">Cancel</button></div>
                <div class="text-wrapper-6"><button class="link-button" style="border:none;background:none;padding:0;margin:0;font:inherit;color:inherit;cursor:pointer;">Arrived</button></div>
              </div>

              <div class="order-1">
                <div class="rectangle"></div>
                <img
                  class="rounded-rectangle"
                  src="img/khichuri.png"
                />
                <div class="text-wrapper">Khichuri</div>
                <div class="text-wrapper-2">ID #3567</div>
                <div class="text-wrapper-3">Table: A1</div>
                <div class="rectangle-2"></div>
                <div class="rectangle-3"></div>
                <div class="text-wrapper-4">Paid</div>
                <div class="text-wrapper-5"><button class="link-button" style="border:none;background:none;padding:0;margin:0;font:inherit;color:inherit;cursor:pointer;">Cancel</button></div>
                <div class="text-wrapper-6"><button class="link-button" style="border:none;background:none;padding:0;margin:0;font:inherit;color:inherit;cursor:pointer;">Arrived</button></div>
              </div>


              <div class="order-1">
                <div class="rectangle"></div>
                <img
                  class="rounded-rectangle"
                  src="img/drinks.png"
                />
                <div class="text-wrapper">Coke</div>
                <div class="text-wrapper-2">ID #3567</div>
                <div class="text-wrapper-3">Table: A2</div>
                <div class="rectangle-2"></div>
                <div class="rectangle-3"></div>
                <div class="text-wrapper-4">Paid</div>
                <div class="text-wrapper-5"><button class="link-button" style="border:none;background:none;padding:0;margin:0;font:inherit;color:inherit;cursor:pointer;">Cancel</button></div>
                <div class="text-wrapper-6"><button class="link-button" style="border:none;background:none;padding:0;margin:0;font:inherit;color:inherit;cursor:pointer;">Arrived</button></div>
              </div>


              <div class="order-1">
                <div class="rectangle"></div>
                <img
                  class="rounded-rectangle"
                    src="img/samosa.png"
                  />
                <div class="text-wrapper">Samosa</div>
                <div class="text-wrapper-2">ID #3567</div>
                <div class="text-wrapper-3">Table: 8</div>
                <div class="rectangle-2"></div>
                <div class="rectangle-3"></div>
                <div class="text-wrapper-4">Paid</div>
                <div class="text-wrapper-5"><button class="link-button" style="border:none;background:none;padding:0;margin:0;font:inherit;color:inherit;cursor:pointer;">Cancel</button></div>
                <div class="text-wrapper-6"><button class="link-button" style="border:none;background:none;padding:0;margin:0;font:inherit;color:inherit;cursor:pointer;">Arrived</button></div>
              </div>


              <div class="order-1">
                <div class="rectangle"></div>
                <img
                  class="rounded-rectangle"
                  src="img/tehari.png"
                />
                <div class="text-wrapper">Tehari</div>
                <div class="text-wrapper-2">ID #3567</div>
                <div class="text-wrapper-3">Table: A9</div>
                <div class="rectangle-2"></div>
                <div class="rectangle-3"></div>
                <div class="text-wrapper-4">Paid</div>
                <div class="text-wrapper-5"><button class="link-button" style="border:none;background:none;padding:0;margin:0;font:inherit;color:inherit;cursor:pointer;">Cancel</button></div>
                <div class="text-wrapper-6"><button class="link-button" style="border:none;background:none;padding:0;margin:0;font:inherit;color:inherit;cursor:pointer;" >Arrived</button></div>
              </div>


              <div class="order-1">
                <div class="rectangle"></div>
                <img
                  class="rounded-rectangle"
                  src="img/noodles.png"
                />
                <div class="text-wrapper">Noodles</div>
                <div class="text-wrapper-2">ID #3567</div>
                <div class="text-wrapper-3">Table: B7</div>
                <div class="rectangle-2"></div>
                <div class="rectangle-3"></div>
                <div class="text-wrapper-4">Paid</div>
                <div class="text-wrapper-5"><button class="link-button" style="border:none;background:none;padding:0;margin:0;font:inherit;color:inherit;cursor:pointer;">Cancel</button></div>
                <div class="text-wrapper-6"><button class="link-button" style="border:none;background:none;padding:0;margin:0;font:inherit;color:inherit;cursor:pointer;">Arrived</button></div>
              </div>

              <div class="order-1">
                <div class="rectangle"></div>
                <img
                  class="rounded-rectangle"
                  src="img/french-fries.png"
                />
                <div class="text-wrapper">French Fries</div>
                <div class="text-wrapper-2">ID #3567</div>
                <div class="text-wrapper-3">Table: B1</div>
                <div class="rectangle-2"></div>
                <div class="rectangle-3"></div>
                <div class="text-wrapper-4">Paid</div>
                <div class="text-wrapper-5"><button class="link-button" style="border:none;background:none;padding:0;margin:0;font:inherit;color:inherit;cursor:pointer;">Cancel</button></div>
                <div class="text-wrapper-6"><button class="link-button" style="border:none;background:none;padding:0;margin:0;font:inherit;color:inherit;cursor:pointer;">Arrived</button></div>
              </div>

              <div class="order-1">
                <div class="rectangle"></div>
                <img
                  class="rounded-rectangle"
                  src="img/drinks.png"
                />
                <div class="text-wrapper">Coke</div>
                <div class="text-wrapper-2">ID #3567</div>
                <div class="text-wrapper-3">Table: B10</div>
                <div class="rectangle-2"></div>
                <div class="rectangle-3"></div>
                <div class="text-wrapper-4">Paid</div>
                <div class="text-wrapper-5"><button class="link-button" style="border:none;background:none;padding:0;margin:0;font:inherit;color:inherit;cursor:pointer;">Cancel</button></div>
                <div class="text-wrapper-6"><button class="link-button" style="border:none;background:none;padding:0;margin:0;font:inherit;color:inherit;cursor:pointer;">Arrived</button></div>
              </div>
              
              

      </div>

      <div class="dashboard-buttons">
        <a href="menu.html" class="div-2">
          <img class="ellipse" src="https://c.animaapp.com/mjq8ikrsnUCmne/img/ellipse-6.png" />
          <div class="text-wrapper-13">Menu</div>
        </a>
        <a href="orders.html" class="div-2">
          <img class="ellipse" src="https://c.animaapp.com/mjq8ikrsnUCmne/img/ellipse-6-1.png" />
          <div class="text-wrapper-14">Orders</div>
        </a>
        <a href="payment.html" class="div-2">
          <img class="ellipse" src="https://c.animaapp.com/mjq8ikrsnUCmne/img/ellipse-6-2.png" />
          <div class="text-wrapper-15">Payment</div>
        </a>
        <a href="table.html" class="div-2">
          <img class="ellipse" src="https://c.animaapp.com/mjq8ikrsnUCmne/img/ellipse-6-3.png" />
          <div class="text-wrapper-16">Tables</div>
        </a>
        <a href="analytics.html" class="div-2">
          <img class="ellipse" src="https://c.animaapp.com/mjq8ikrsnUCmne/img/ellipse-6-4.png" />
          <div class="text-wrapper-17">Analytics</div>
        </a>
      </div>
     </div>
      

      <footer class="footer">
        <div class="t-c">
          <div class="group-2">
            <div class="terms-conditions">Terms &amp; Conditions</div>
            <p class="p">Â© . All rights reserved</p>
            <div class="text-wrapper-18">Contact us</div>
          </div>
        </div>
      </footer>
   </div>
  </body>
  <script>
    function toggleProfileDropdown() {
      const dropdown = document.getElementById('profileDropdown');
      dropdown.classList.toggle('active');
    }

    function logout() {
      alert('Logging out...');
    }

    document.addEventListener('click', function(event) {
      const dropdown = document.getElementById('profileDropdown');
      const profileButton = document.querySelector('.profile-button');
      if (dropdown && profileButton && !profileButton.contains(event.target) && !dropdown.contains(event.target)) {
        dropdown.classList.remove('active');
      }
    });

    // Notify analytics via localStorage when orders are approved/cancelled
    (function() {
      const STORAGE_KEY = 'qrcafe_orders';

      function getOrders() {
        try { return JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]'); } catch(e){ return []; }
      }
      function saveOrders(orders) { localStorage.setItem(STORAGE_KEY, JSON.stringify(orders)); localStorage.setItem(STORAGE_KEY + '_updated_at', Date.now()); }

      function addOrderByName(name, qty=1) {
        const orders = getOrders();
        orders.push({ items:[{ name: name.trim(), qty: qty, price:0 }], total:0, ts: Date.now() });
        saveOrders(orders);
      }

      function removeOneItemByName(name, qtyToRemove=1) {
        const orders = getOrders();
        let remaining = qtyToRemove;
        for (let i = 0; i < orders.length && remaining > 0; i++) {
          const ord = orders[i];
          if (!ord.items) continue;
          for (let j = 0; j < ord.items.length && remaining > 0; j++) {
            const it = ord.items[j];
            if (it.name && it.name.trim() === name.trim()) {
              const take = Math.min(it.qty || 1, remaining);
              it.qty = (it.qty || 1) - take;
              remaining -= take;
              if (it.qty <= 0) {
                ord.items.splice(j,1); j--; 
              }
            }
          }
          if (!ord.items || ord.items.length === 0) { orders.splice(i,1); i--; }
        }
        saveOrders(orders);
      }

      // Attach listeners to each order card's Cancel and Arrived buttons
      document.querySelectorAll('.order-1').forEach(card => {
        const nameEl = card.querySelector('.text-wrapper');
        const cancelBtn = card.querySelector('.text-wrapper-5 button');
        const arrivedBtn = card.querySelector('.text-wrapper-6 button');
        const productName = nameEl ? nameEl.textContent.trim() : null;
        if (!productName) return;
        if (arrivedBtn) arrivedBtn.addEventListener('click', function(){ addOrderByName(productName, 1); alert(productName + ' marked arrived and added to analytics'); });
        if (cancelBtn) cancelBtn.addEventListener('click', function(){
          removeOneItemByName(productName, 1);
          // remove the order card from the UI
          if (card && card.parentNode) card.parentNode.removeChild(card);
          alert(productName + ' cancelled and removed from analytics');
        });
      });
    })();
  </script>
</html>
